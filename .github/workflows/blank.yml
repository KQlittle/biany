name: Build and release ddns

on:
  push:
    branches:
      - main

jobs:
  build-x86_64:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Install build tools
        run: sudo apt-get install build-essential
      - name: Compile shell script
        run: gcc ddns.sh -o ddns_x86_64
      - name: Upload to release
        uses: actions/upload-artifact@v2
        with:
          name: ddns
          path: ddns_x86_64
  build-amd:
    runs-on: amd64-linux-latest
    steps:
      - uses: actions/checkout@v2
      - name: Install build tools
        run: sudo apt-get install build-essential
      - name: Compile for amd64
        run: gcc ddns.sh -o ddns_amd64
      - name: Upload to release
        uses: actions/upload-artifact@v2
        with:
          name: ddns
          path: ddns_amd64
  build-arm64:
    runs-on: aarch64-linux-latest
    steps:
      - uses: actions/checkout@v2
      - name: Install build tools
        run: sudo apt-get install build-essential
      - name: Compile shell script
        run: gcc ddns.sh -o ddns_arm64
      - name: Upload to release
        uses: actions/upload-artifact@v2
        with:
          name: ddns
          path: ddns_arm64
  build-all:
    runs-on: armv7l-linux-latest
    steps:
      - uses: actions/checkout@v2
      - name: Install build tools
        run: sudo apt-get install build-essential
      - name: Compile for armv7l
        run: gcc ddns.sh -o ddns_armv7l
      - name: Upload to release
        uses: actions/upload-artifact@v2
        with:
          name: ddns
          path: ddns_armv7l
